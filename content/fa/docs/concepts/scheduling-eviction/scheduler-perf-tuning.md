---
reviewers:
- bsalamat
title: بهینه‌سازی عملکرد برنامه‌ریزی
content_type: concept
weight: 70
---

{{< feature-state for_k8s_version="v1.14" state="beta" >}}

[kube-scheduler](/docs/concepts/scheduling-eviction/kube-scheduler/#kube-scheduler)
برنامه‌ریز پیش‌فرض Kubernetes است که مسئول قرار دادن پادها روی گره‌ها در یک خوشه است.

گره‌هایی در یک خوشه که به نیازمندی‌های برنامه‌ریزی پاد پاسخ می‌دهند، گره‌های _قابل‌اجرا_ برای پاد هستند. برنامه‌ریز پس از پیدا کردن گره‌های قابل‌اجرا برای یک پاد، یک مجموعه عملکردهای امتیازدهی را اجرا می‌کند تا گره‌ای با بالاترین امتیاز را انتخاب کند تا پاد را اجرا کند. سپس برنامه‌ریز API سرور را در یک فرآیند به نام _Binding_ از این تصمیم مطلع می‌سازد.

این صفحه بهینه‌سازی‌های تنظیماتی را که برای خوشه‌های بزرگ Kubernetes مناسب است توضیح می‌دهد.

### تنظیم آستانه

گزینه `percentageOfNodesToScore` از طریق تنظیمات kube-scheduler قابل پیکربندی است. این تنظیم تعیین می‌کند که چه درصدی از گره‌های خوشه باید برای برنامه‌ریزی مورد نظر بررسی شود.

### تنظیم آستانه

گزینه `percentageOfNodesToScore` عددی صحیح بین 0 تا 100 را می‌پذیرد. عدد 0 عدد خاصی است که نشان می‌دهد kube-scheduler باید از تنظیمات پیش‌فرض خود استفاده کند. اگر `percentageOfNodesToScore` را بالاتر از 100 تنظیم کنید، kube-scheduler مانند این است که عدد 100 را تنظیم کرده‌اید.

برای تغییر این مقدار، فایل پیکربندی kube-scheduler را ویرایش کنید و سپس برنامه‌ریز را مجدداً راه‌اندازی کنید.

### مثال

در زیر مثالی از پیکربندی که `percentageOfNodesToScore` را به 50% تنظیم می‌کند آمده است.

```yaml
apiVersion: kubescheduler.config.k8s.io/v1alpha1
kind: KubeSchedulerConfiguration
algorithmSource:
  provider: DefaultProvider

...

percentageOfNodesToScore: 50
```

### بهینه‌سازی `percentageOfNodesToScore`

`percentageOfNodesToScore` باید یک مقدار بین 1 تا 100 باشد و مقدار پیش‌فرض بر اساس اندازه خوشه محاسبه می‌شود. مقدار حداقلی ثابت برای این تنظیمات نیز وجود دارد که برابر با 50 گره است.

{{< note >}}در خوشه‌هایی که کمتر از 50 گره قابل‌اجرا وجود دارد، برنامه‌ریز همچنان تمام گره‌ها را بررسی می‌کند زیرا گره‌های قابل‌اجرا کافی برای متوقف کردن جستجوی برنامه‌ریز نیستند.

در یک خوشه کوچک، اگر برای `percentageOfNodesToScore` مقدار کمی تنظیم کنید، تغییر شما تاثیر چندانی نخواهد داشت. اگر خوشه شما چندین صد گره یا کمتر دارد، بهتر است این تنظیم را به مقدار پیش‌فرض خود رها کنید. انجام تغییرات به احتمال زیاد عملکرد برنامه‌ریز را به طور قابل توجهی بهبود نخواهد داد.
{{< /note >}}

برای تنظیم این مقدار باید دقت کنید که در صورتی که تعداد کمتری از گره‌ها در یک خوشه برای بررسی قابلیت‌پذیری چک شوند، برخی از گره‌ها حتی به مرحله امتیازدهی برای یک پاد داده نمی‌شوند. به عبارت دیگر، گره‌ای که ممکن است امتیاز بالاتری برای اجرای پاد مورد نظر داشته باشد، حتی به مرحله امتیازدهی نمی‌رسد که منجر به قرارگیری کم‌تر ایده‌آل پاد می‌شود.

بهتر است از تنظیم مقدار `percentageOfNodesToScore` به شکل بسیار پایین خودداری کنید تا kube-scheduler تصمیمات پراکندگی نامناسب برای قرارگیری پادها را به طور مکرر نگیرد. اجتناب از تنظیم درصد به کمتر از 10% را توصیه می‌کنیم، مگر اینکه توانایی عبور برنامه‌ریز از لحاظ توانایی عملیاتی برنامه‌ریز برای برنامه‌های شما اهمیت زیادی داشته باشد و امتیاز گره‌ها اهمیتی نداشته باشد. به عبارت دیگر، شما ترجیح می‌دهید پاد را روی هر گره‌ای اجرا کنید تا آن را از نظر قابلیت اجرایی امکان‌پذیر بدانید.

### چگونگی اسکن گره‌ها توسط برنامه‌ریز

این بخش برای افرادی است که می‌خواهند جزئیات داخلی این ویژگی را

 بفهمند.

برای دادن فرصت منصفانه به تمام گره‌های یک خوشه برای در نظر گرفتن برای اجرای پادها، برنامه‌ریز به صورت گردان بر روی گره‌ها اسکن می‌کند. می‌توانید تصور کنید که گره‌ها در یک آرایه هستند. برنامه‌ریز از ابتدای آرایه شروع می‌کند و قابلیت‌پذیری گره‌ها را چک می‌کند تا تعداد کافی از گره‌ها به عنوان مشخص شده توسط `percentageOfNodesToScore` را پیدا کند. برای پاد بعدی، برنامه‌ریز از نقطه در آرایه گره‌ها که در زمان چک قابلیت اجرای پاد قبلی متوقف شده است ادامه می‌دهد.

اگر گره‌ها در مناطق مختلف باشند، برنامه‌ریز بر روی گره‌ها در مناطق مختلف اسکن می‌کند تا اطمینان حاصل شود که گره‌های مناطق مختلف در بررسی‌های قابلیت‌پذیری در نظر گرفته شده‌اند.

### {{% heading "whatsnext" %}}

* به [مرجع تنظیمات پیکربندی kube-scheduler (v1)](/docs/reference/config-api/kube-scheduler-config.v1/) مراجعه کنید.
