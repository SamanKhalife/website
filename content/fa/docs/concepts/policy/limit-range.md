---
reviewers:
- nelvadas
title: محدوده‌های محدودیت
api_metadata:
- apiVersion: "v1"
  kind: "LimitRange"
content_type: concept
weight: 10
---

<!-- overview -->

به طور پیش‌فرض، کانتینرها در یک خوشه Kubernetes با منابع محاسباتی بی‌محدود اجرا می‌شوند. با استفاده از [سربار منابع Kubernetes](/docs/concepts/policy/resource-quotas/)، مدیران (معمولاً به عنوان _اپراتورهای خوشه_) می‌توانند مصرف و ایجاد منابع خوشه را (مانند زمان CPU، حافظه و ذخیره‌سازی ماندگار) را در یک فضای نام مشخص محدود کنند. در یک فضای نام، یک {{< glossary_tooltip text="Pod" term_id="Pod" >}} می‌تواند هر قدر که مجاز به ResourceQuotas که برای آن فضای نام اعمال می‌شود، CPU و حافظه را مصرف کند. به عنوان یک اپراتور خوشه یا به عنوان مدیر سطح فضای نام، شما ممکن است همچنین به اطمینان از اینکه یک شیء تکمیلی نتواند تمام منابع موجود در یک فضای نام را مشترک کند، علاقه‌مند باشید.

یک محدوده محدودیت یک سیاست برای محدود کردن اختصاص منابع (محدودیت‌ها و درخواست‌ها) است که می‌توانید برای هر نوع شیء قابل اجرا (مانند Pod یا {{< glossary_tooltip text="PersistentVolumeClaim" term_id="persistent-volume-claim" >}}) در یک فضای نام تعیین کنید.

<!-- body -->

یک _محدوده محدودیت_ می‌تواند محدودیت‌های زیر را اعمال کند:

- اعمال استفاده حداقل و حداکثر منابع محاسباتی برای هر Pod یا Container در یک فضای نام.
- اعمال درخواست و حداکثر درخواست ذخیره‌سازی برای {{< glossary_tooltip text="PersistentVolumeClaim" term_id="persistent-volume-claim" >}} در یک فضای نام.
- اعمال نسبت بین درخواست و حد برای یک منبع در یک فضای نام.
- تنظیم مقادیر پیش‌فرض درخواست/حد برای منابع محاسباتی در یک فضای نام و در زمان اجرا به‌صورت خودکار آن‌ها را به کانتینرها درج می‌کند.

یک محدوده محدودیت در یک فضای نام خاص اجرا می‌شود هنگامی که یک شیء LimitRange در آن فضای نام وجود دارد.

نام یک شیء LimitRange باید یک نام زیردامنه DNS معتبر باشد.

## محدودیت‌ها بر روی حدود منابع و درخواست‌ها

- مدیر یک محدوده محدودیت را در یک فضای نام ایجاد می‌کند.
- کاربران شیء‌ها را در آن فضای نام ایجاد می‌کنند (یا سعی می‌کنند ایجاد کنند)، مانند Pods یا PersistentVolumeClaims.
- ابتدا، کنترل‌کننده تأیید LimitRange مقادیر پیش‌فرض درخواست و حد برای تمام Pods (و کانتینرهای آن‌ها) را که نیازمندی‌های منابع محاسباتی را تنظیم نکرده‌اند، اعمال می‌کند.
- ثانیا، LimitRange استفاده را پیگیری می‌کند تا اطمینان حاصل شود که استفاده از منابع حداقل، حداکثر و نسبت در هر LimitRange تعیین شده در فضای نام را تجاوز نمی‌کند.
- اگر سعی در ایجاد یا به‌روزرسانی یک شیء (Pod یا PersistentVolumeClaim) که درگیر یک محدوده محدودیت است را داشته باشید، درخواست شما به سرور API با کد وضعیت HTTP `403 Forbidden` و یک پیامی که محدودیتی که نقض شده است را توضیح می‌دهد، شکست خواهد خورد.
- اگر یک LimitRange را در یک فضای نام اضافه کنید که به منابع محاسباتی مرتبط با cpu و memory اعمال می‌شود، باید برای این مقادیر درخواست یا حد مشخص کنید. در غیر این صورت، سیستم ممکن است ایجاد Pod را رد کند.
- اعتبارسنجی‌های LimitRange فقط در مرحله تأیید Pod اتفاق می‌افتد، نه بر روی Pods در حال اجرا. اگر یک LimitRange را اضافه یا تغییر دهید، Pods که در حال حاضر در آن فضای نام وجود دارند بدون تغییر ادامه می‌یابند.
- اگر دو یا بیشتر شیء LimitRange در فضای نام وجود داشته باشد، مشخص نیست که مقدار پیش‌فرضی کدام اعمال خواهد شد.

## LimitRange و بررسی‌های تأیید برای Pods

یک `LimitRange` بررسی هم‌گرایی مقادیر پیش‌فرضی که اعمال می‌کند را **انجام نمی‌دهد**. این به معنای آن است که یک مقدار پیش‌فرض برای _حدّ_ که توسط `LimitRange` تنظیم شده است ممکن است کمتر از مقدار _درخواست_ مشخص شده برای کانتینر در مشخصه‌ای که کاربر به سرور API ارسال می‌کند باشد. اگر چنین اتفاقی رخ دهد، Pod نهای

ی قابل زمان‌بندی نخواهد بود.

به عنوان مثال، شما یک `LimitRange` با این اظهارنامه تعریف می‌کنید:

{{% code_sample file="concepts/policy/limit-range/problematic-limit-range.yaml" %}}


همراه با یک Pod که درخواست منبع CPU 700m را اعلام می‌کند، اما حد مشخصی ندارد:

{{% code_sample file="concepts/policy/limit-range/example-conflict-with-limitrange-cpu.yaml" %}}


آن Pod با خطای مشابه زیر ارسال می‌شود:

```
Pod "example-conflict-with-limitrange-cpu" is invalid: spec.containers[0].resources.requests: Invalid value: "700m": must be less than or equal to cpu limit
```

اگر همچنین درخواست و حد را تعیین کنید، آن Pod جدید با این LimitRange با موفقیت زمان‌بندی خواهد شد:

{{% code_sample file="concepts/policy/limit-range/example-no-conflict-with-limitrange-cpu.yaml" %}}

## مثال‌های محدودیت‌های منابع

نمونه‌هایی از سیاست‌هایی که می‌توان با استفاده از `LimitRange` ایجاد کرد عبارتند از:

- در یک خوشه 2 گره با ظرفیت 8 گیگابایت حافظه RAM و 16 هسته، محدود کردن Pods در یک فضای نام به درخواست 100m CPU با حداکثر حد 500m برای CPU و درخواست 200Mi برای حافظه با حداکثر 600Mi برای حافظه.
- تعیین درخواست و حد پیش‌فرض CPU به 150m و درخواست حافظه پیش‌فرض به 300Mi برای Containers که بدون درخواست‌های CPU و حافظه در مشخصه‌های خود راه‌اندازی می‌شوند.

در صورتی که مجموع حدود فضای نام کمتر از جمع حدود Pods/Containers باشد، ممکن است برای منابع رقابت وجود داشته باشد. در این حالت، کانتینرها یا Pods ایجاد نمی‌شوند.

نه رقابت و نه تغییرات در یک LimitRange بر روی منابعی که قبلاً ایجاد شده‌اند تأثیری ندارد.

## {{% heading "whatsnext" %}}

برای مثال‌هایی از استفاده از محدودیت‌ها، به موارد زیر مراجعه کنید:

- [چگونه برای هر فضای نام محدودیت‌های حداقل و حداکثر CPU را پیکربندی کنیم](/docs/tasks/administer-cluster/manage-resources/cpu-constraint-namespace/).
- [چگونه برای هر فضای نام محدودیت‌های حداقل و حداکثر حافظه را پیکربندی کنیم](/docs/tasks/administer-cluster/manage-resources/memory-constraint-namespace/).
- [چگونه برای هر فضای نام درخواست و حداکثر CPU پیش‌فرض را پیکربندی کنیم](/docs/tasks/administer-cluster/manage-resources/cpu-default-namespace/).
- [چگونه برای هر فضای نام درخواست و حداکثر حافظه پیش‌فرض را پیکربندی کنیم](/docs/tasks/administer-cluster/manage-resources/memory-default-namespace/).
- [چگونه برای هر فضای نام مصرف حداقل و حداکثر ذخیره‌سازی را محدود کنیم](/docs/tasks/administer-cluster/limit-storage-consumption/#limitrange-to-limit-requests-for-storage).
- [یک مثال دقیق برای پیکربندی سهم‌های فضای نام](/docs/tasks/administer-cluster/manage-resources/quota-memory-cpu-namespace/).

برای درک و اطلاعات تاریخی، به [مستند طراحی LimitRanger](https://git.k8s.io/design-proposals-archive/resource-management/admission_control_limit_range.md) مراجعه کنید.
